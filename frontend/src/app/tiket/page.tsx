"use client";import React, { useState, useEffect } from 'react';import { useRouter } from 'next/navigation';type StoredTicket = {    location_name?: string;    ticket_number?: string;    code?: string;    time_slot?: string;};type StoredUser = {    nik: string;    whatsapp: string;    nama: string;};function readStoredItem<T>(key: string): T | null {    if (typeof window === 'undefined') return null;    const stored = localStorage.getItem(key);    if (!stored) return null;    try {        return JSON.parse(stored) as T;    } catch {        return null;    }}export default function TiketPage() {    const router = useRouter();    const [ticket] = useState<StoredTicket | null>(() => readStoredItem<StoredTicket>('ticket'));    const [user] = useState<StoredUser | null>(() => readStoredItem<StoredUser>('user'));    useEffect(() => {        if (!ticket || !user) {            router.push('/antrean');        }    }, [router, ticket, user]);    const maskNIK = (nik: string) => {        if (!nik) return '';        return '*'.repeat(12) + nik.slice(-4);    };    const maskPhone = (phone: string) => {        if (!phone) return '';        return '*'.repeat(7) + phone.slice(-4);    };    const handlePrint = () => {        window.print();    };    if (!ticket || !user) return null;    const today = new Date();    const dateStr = today.toLocaleDateString('id-ID', {        weekday: 'long', day: 'numeric', month: 'long', year: 'numeric'    });    return (        <div className="min-vh-100 d-flex align-items-center justify-content-center py-5"            style={{ background: 'linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)' }}>            <div className="card shadow-lg border-0 text-center"                style={{ maxWidth: '380px', borderRadius: '1.5rem' }}>                <div className="card-body p-4">                    {/* Header */}                    <p className="text-muted mb-2" style={{ fontSize: '0.9rem' }}>                        {ticket.location_name || 'Butik Emas LM - Setiabudi One'}                    </p>                    {/* Ticket Number */}                    <h1 className="display-4 fw-bold mb-3" style={{ color: '#4a4a6a', letterSpacing: '3px' }}>                        {ticket.ticket_number || 'AJK4-041'}                    </h1>                    {/* QR Code Placeholder */}                    <div className="mx-auto mb-3"                        style={{                            width: '150px', height: '150px',                            background: '#222',                            borderRadius: '8px',                            display: 'flex',                            alignItems: 'center',                            justifyContent: 'center'                        }}>                        <div style={{                            width: '130px', height: '130px',                            background: `url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect fill='white' width='100' height='100'/%3E%3Crect fill='black' x='10' y='10' width='20' height='20'/%3E%3Crect fill='black' x='40' y='10' width='10' height='10'/%3E%3Crect fill='black' x='60' y='10' width='10' height='10'/%3E%3Crect fill='black' x='70' y='10' width='20' height='20'/%3E%3Crect fill='black' x='10' y='40' width='10' height='10'/%3E%3Crect fill='black' x='30' y='40' width='10' height='10'/%3E%3Crect fill='black' x='50' y='40' width='10' height='10'/%3E%3Crect fill='black' x='70' y='40' width='20' height='10'/%3E%3Crect fill='black' x='10' y='60' width='10' height='10'/%3E%3Crect fill='black' x='30' y='60' width='10' height='10'/%3E%3Crect fill='black' x='50' y='60' width='20' height='10'/%3E%3Crect fill='black' x='10' y='70' width='20' height='20'/%3E%3Crect fill='black' x='40' y='70' width='10' height='10'/%3E%3Crect fill='black' x='60' y='80' width='10' height='10'/%3E%3Crect fill='black' x='80' y='70' width='10' height='20'/%3E%3C/svg%3E") center/cover`                        }} />                    </div>                    {/* Ticket Code */}                    <h2 className="fw-bold mb-4" style={{ color: '#4a4a6a', fontSize: '2rem' }}>                        {ticket.code || '937A55'}                    </h2>                    {/* User Info */}                    <div className="text-start mx-auto" style={{ maxWidth: '280px' }}>                        <p className="mb-2">                            <span className="text-muted">NIK</span> : <span className="fw-semibold">{maskNIK(user.nik)}</span>                        </p>                        <p className="mb-2">                            <span className="text-muted">Phone</span>: <span className="fw-semibold">{maskPhone(user.whatsapp)}</span>                        </p>                        <p className="mb-3">                            <span className="text-muted">Nama</span>: <span className="fw-bold">{user.nama.toUpperCase()}</span>                        </p>                    </div>                    {/* Schedule */}                    <div className="py-3 px-2 rounded mb-3" style={{ background: '#f8f9fa' }}>                        <p className="mb-1 fw-bold" style={{ color: '#764ba2' }}>Waktu Kedatangan</p>                        <p className="mb-0 fw-semibold">{dateStr}</p>                        <p className="mb-0 fw-bold" style={{ color: '#764ba2' }}>                            Pukul {ticket.time_slot || '08:30:00-09:00:00 WIB'}                        </p>                    </div>                    {/* Warning */}                    <p className="small text-muted mb-3" style={{ fontSize: '0.75rem' }}>                        *Butik berhak membatalkan transaksi jika terdeteksi bahwa pembeli                        telah melakukan transaksi lebih dari 2 (dua) kali dalam 1 (satu) bulan.                    </p>                    {/* Print Button */}                    <button                        className="btn btn-lg w-100 text-white fw-bold"                        style={{ background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' }}                        onClick={handlePrint}                    >                        CETAK TIKET                    </button>                    <a href="/antrean" className="btn btn-link mt-2 text-decoration-none" style={{ color: '#764ba2' }}>                        Kembali ke Antrean                    </a>                </div>            </div>        </div>    );}